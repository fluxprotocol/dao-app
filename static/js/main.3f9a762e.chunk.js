(this["webpackJsonpdao-app"]=this["webpackJsonpdao-app"]||[]).push([[0],{124:function(t,e,n){t.exports={paper:"Dialog_paper__XrzDE",cancelButton:"Dialog_cancelButton__3SRaV",confirmButton:"Dialog_confirmButton__OGdmB"}},201:function(t,e,n){t.exports={button:"Button_button__2Lf63"}},202:function(t){t.exports=JSON.parse('{"global.appName":"Flux DAO","global.action.cancel":"Cancel","global.action.submit":"Submit","home.title":"Proposals","menu.loggedInAs":"Hello :accountId","menu.login":"Login","menu.logout":"Logout","menu.item.home":"Home","menu.item.council":"Council","menu.item.auth":"Authenticate user","council.title":"Council","resoluteMarketForm.input.validMarket":"Valid","resoluteMarketForm.input.invalidMarket":"Invalid","resoluteMarketForm.input.marketId":"Market id","resoluteMarketForm.input.payoutNumerator":"Payout numerator","resoluteMarketForm.input.payoutNumeratorHelper":"Seperate percentages with a space example: 50 0 50","resoluteMarketForm.error.not100":"Outcome values should be a cumulative sum of 100%","newCouncilForm.input.accountId":"Account id","newCouncilForm.input.description":"Description of proposal","addTokenWhitelist.input.accountId":"Token address id","addTokenWhitelist.input.description":"Description of proposal","proposalInfo.label.status":"Status: :status","proposalInfo.label.creator":"Creator: :creator","proposalInfo.label.votePeriodEnd":"Vote period end: :date","proposalInfo.action.voteYes":"Approve (:amount)","proposalInfo.action.voteNo":"Reject (:amount)","proposalInfo.action.finalize":"Finalize","proposalsOverview.create":"Create proposal","proposal.resoluteMarket.description":"Resolute market: :description","proposalDialog.title":"Create a proposal","proposalDialog.types.newCouncil":"New council","proposalDialog.types.addTokenWhitelist":"Add token to the whitelist","proposalDialog.types.resoluteMarket":"Resolute market","auth.dialog.title":"Authenticate user","auth.form.input.accountId":"example.near","auth.dialog.cannotAuthenticate":"No authentication rights"}')},206:function(t,e,n){t.exports={root:"OptionSwitch_root__URwjr"}},207:function(t,e,n){t.exports={infiniteScroll:"ProposalsOverview_infiniteScroll__yBduR"}},234:function(t,e){},239:function(t,e){},262:function(t,e){},264:function(t,e){},317:function(t,e,n){},318:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n(19),o=n.n(a),c=n(83),i=n(27),u=n(373),s=n(10),l=n(21),p=n(6),d=n.n(p),f=n(12),b=n(77),j=n(377),h=n(363),v=n(364),O=n(365),x=n(213),k=n(359),m=n(201),g=n.n(m),_=n(4);function y(t){var e=t.className,n=void 0===e?"":e,r=t.children,a=Object(x.a)(t,["className","children"]);return Object(_.jsx)(k.a,Object(s.a)(Object(s.a)({},a),{},{className:"".concat(g.a.button," ").concat(n),children:r}))}var w=n(124),C=n.n(w),A=n(202);function I(t,e,n){var r=A[t];if(!r)return console.info("Transaltion not found for",t),t;var a,o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.replace(/:(\w+)/gi,(function(t){var n=t.replace(/^:/,"");return void 0===e[n]||null===e[n]?"":e[n]}))}(r,e);return n?(a=o).charAt(0).toUpperCase()+a.substring(1):o}function T(t){var e=t.title,n=t.children,r=t.open,a=t.onRequestClose,o=t.onSubmitClick;return Object(_.jsxs)(j.a,{open:r,classes:{paper:C.a.paper},children:[Object(_.jsx)(h.a,{children:e}),Object(_.jsx)(v.a,{children:n}),Object(_.jsxs)(O.a,{children:[Object(_.jsx)(y,{className:C.a.cancelButton,onClick:a,children:I("global.action.cancel")}),Object(_.jsx)(y,{className:C.a.confirmButton,onClick:o,children:I("global.action.submit")})]})]})}var M=n(376);function P(t){var e=t.onChange,n=t.values;return Object(_.jsx)("div",{children:Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:I("auth.form.input.accountId"),onChange:function(t){e({accountId:t.currentTarget.value})},value:n.accountId})})})}function S(){return{accountId:""}}function N(t){var e=t.canAuthenticate,n=t.onSubmit,a=Object(l.f)(),o=Object(r.useState)(S),c=Object(b.a)(o,2),i=c[0],u=c[1];if(!e)return Object(_.jsx)("div",{children:I("auth.dialog.cannotAuthenticate")});return Object(_.jsx)(T,{title:I("auth.dialog.title"),open:!0,onRequestClose:function(){return a.push("/")},onSubmitClick:function(){return n(i.accountId)},children:Object(_.jsx)(P,{onChange:function(t){u({accountId:t.accountId})},values:i})})}var R=n(117),E=n(118),D=n(33),F=n.n(D),L=n(119),W="https://mainnet-api.flux.xyz/graphql",B="null_address.near",z=new F.a("100000000000000"),U=Object({NODE_ENV:"production",PUBLIC_URL:"https://fluxprotocol.github.io/dao-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://mainnet-api.flux.xyz/graphql",REACT_APP_DAO_ACCOUNT_ID:"dao.counselor.near",REACT_APP_FLUX_MARKET_DETAIL_URL:"https://fluxprotocol.github.io/beta/#/beta/markets/",REACT_APP_NETWORK:"mainnet"}).REACT_APP_AUTH_ACCOUNT_ID||"",q=new F.a("30000000000000000000000"),H=n(203),K=new(n.n(H).a)({network:"mainnet",nullContractId:B,graphApiUrl:W});function V(){return Y.apply(this,arguments)}function Y(){return(Y=Object(f.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K.connect();case 2:return t.abrupt("return",K);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function J(){return X.apply(this,arguments)}function X(){return(X=Object(f.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,V();case 2:return e=t.sent,t.abrupt("return",e.walletConnection);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var G,Q=function(){function t(e){Object(R.a)(this,t),this.contract=void 0,this.contract=new L.Contract(e,U,{viewMethods:["is_authenticated","can_authenticate"],changeMethods:["add_authenticatee"]})}return Object(E.a)(t,[{key:"isAuthenticated",value:function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.is_authenticated({account_id:e});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"canAuthenticate",value:function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.can_authenticate({account_id:e});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"addAuthenticatee",value:function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.add_authenticatee({account_id:e},z,new F.a(0));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();function Z(){return $.apply(this,arguments)}function $(){return($=Object(f.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Q){t.next=2;break}return t.abrupt("return",G);case 2:return t.next=4,J();case 4:return e=t.sent,G=new Q(e.account()),t.abrupt("return",G);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var tt=n(52),et=Object(tt.a)({initialState:{canAuthenticate:!1,loading:!0,errors:[]},name:"council",reducers:{setAuth:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{canAuthenticate:e.payload})},setAuthLoading:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{loading:e.payload})},setAuthErrors:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{errors:e.payload})}}}),nt=et.actions,rt=nt.setAuth,at=nt.setAuthErrors,ot=nt.setAuthLoading,ct=et.reducer;function it(t){return function(){var e=Object(f.a)(d.a.mark((function e(n){var r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return r=e.sent,n(ot(!0)),e.next=6,r.addAuthenticatee(t);case 6:n(ot(!1));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function ut(t){return function(){var e=Object(f.a)(d.a.mark((function e(n){var r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:return r=e.sent,n(ot(!0)),e.next=6,r.isAuthenticated(t);case 6:return a=e.sent,n(ot(!1)),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}function st(){var t=Object(i.b)(),e=Object(i.c)((function(t){return t.auth.canAuthenticate})),n=Object(i.c)((function(t){return t.account.account}));function a(){return(a=Object(f.a)(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ut(n)(t);case 2:if(!e.sent){e.next=5;break}return e.abrupt("return",console.error("user is already authenticated"));case 5:t(it(n));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){var e;n&&t((e=n.accountId,function(){var t=Object(f.a)(d.a.mark((function t(n){var r,a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(ot(!0)),t.next=4,Z();case 4:return r=t.sent,t.next=7,r.canAuthenticate(e);case 7:a=t.sent,n(rt(a)),n(ot(!1)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),n(at(t.t0)),n(ot(!1));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()))}),[n]),Object(_.jsx)(N,{canAuthenticate:e,onSubmit:function(t){return a.apply(this,arguments)}})}var lt=n(92),pt=n(204),dt=n.n(pt);function ft(){return Object(_.jsx)("footer",{})}function bt(t){var e=t.onLoginClick,n=t.onLogoutClick,r=t.account;return Object(_.jsxs)("section",{children:[!r&&Object(_.jsx)("button",{onClick:e,children:I("menu.login")}),r&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("span",{children:I("menu.loggedInAs",{accountId:r.accountId})}),Object(_.jsx)("button",{onClick:n,children:I("menu.logout")})]}),Object(_.jsx)(c.b,{to:We.root(),children:I("menu.item.home")}),Object(_.jsx)(c.b,{to:We.council(),children:I("menu.item.council")}),r&&Object(_.jsx)(c.b,{to:We.auth(),children:I("menu.item.auth")})]})}var jt=Object(tt.a)({initialState:{account:null,loading:!1,errors:[]},name:"account",reducers:{setAccount:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{account:e.payload})},setAccountLoading:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{loading:e.payload})},setAccountErrors:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{errors:e.payload})}}}),ht=jt.actions,vt=ht.setAccount,Ot=(ht.setAccountErrors,ht.setAccountLoading),xt=jt.reducer;function kt(){return mt.apply(this,arguments)}function mt(){return(mt=Object(f.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J();case 2:t.sent.requestSignIn(B,I("global.appName"));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function gt(){return _t.apply(this,arguments)}function _t(){return(_t=Object(f.a)(d.a.mark((function t(){var e,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J();case 2:if((e=t.sent).isSignedIn()){t.next=5;break}return t.abrupt("return",null);case 5:return n=e.account(),t.t0=n.accountId,t.next=9,n.getAccountBalance();case 9:return t.t1=t.sent.available,t.abrupt("return",{accountId:t.t0,balance:t.t1});case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yt(){return wt.apply(this,arguments)}function wt(){return(wt=Object(f.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J();case 2:t.sent.signOut();case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Ct,At=function(){function t(e){Object(R.a)(this,t),this.contract=void 0,this.contract=new L.Contract(e,"dao.counselor.near",{viewMethods:["get_council","get_bond","get_proposals","get_proposal"],changeMethods:["add_proposal","vote","finalize","finalize_external"]})}return Object(E.a)(t,[{key:"getCouncil",value:function(){var t=Object(f.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.get_council({a:1});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getBond",value:function(){var t=Object(f.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.get_bond({a:1});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getProposals",value:function(){var t=Object(f.a)(d.a.mark((function t(){var e,n,r,a=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:"0",n=a.length>1&&void 0!==a[1]?a[1]:"1000",t.next=4,this.contract.get_proposals({from_index:e,limit:n});case 4:return r=t.sent,t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getProposal",value:function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.contract.get_proposal({id:e});case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createResoluteMarketProposal",value:function(){var t=Object(f.a)(d.a.mark((function t(e,n,r){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.contract.add_proposal({proposal:{description:e,kind:{market_id:n,payout_numerator:r,type:"ResoluteMarket"}}},z,q);case 1:case"end":return t.stop()}}),t,this)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"createNewCouncilProposal",value:function(){var t=Object(f.a)(d.a.mark((function t(e,n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.contract.add_proposal({proposal:{description:e,kind:{target:n,type:"NewCouncil"}}},z,q);case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"createAddTokenToWhitelistProposal",value:function(){var t=Object(f.a)(d.a.mark((function t(e,n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.contract.add_proposal({proposal:{description:e,kind:{to_add:n,type:"AddTokenWhitelist"}}},z,q);case 1:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"vote",value:function(t,e){this.contract.vote({id:t,vote:e},z,new F.a(0))}},{key:"finalize",value:function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getProposal(e);case 2:"ResoluteMarket"===(n=t.sent).kind.type||"AddTokenWhitelist"===n.kind.type?this.contract.finalize_external({id:e},z,new F.a(0)):this.contract.finalize({id:e},z,new F.a(0));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();function It(){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(f.a)(d.a.mark((function t(){var e;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Ct){t.next=2;break}return t.abrupt("return",Ct);case 2:return t.next=4,J();case 4:return e=t.sent,Ct=new At(e.account()),t.abrupt("return",Ct);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var Mt=Object(tt.a)({initialState:{loading:!1,errors:[]},name:"daoInfo",reducers:{setDaoInfo:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{daoInfo:e.payload})},setDaoLoading:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{loading:e.payload})},setDaoErrors:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{errors:e.payload})}}}),Pt=Mt.actions,St=Pt.setDaoErrors,Nt=Pt.setDaoInfo,Rt=Pt.setDaoLoading,Et=Mt.reducer;function Dt(){var t=Object(i.b)(),e=Object(i.c)((function(t){return t.account.account}));Object(r.useEffect)((function(){e||t(function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(Ot(!0)),t.next=4,gt();case 4:n=t.sent,e(vt(n)),e(Ot(!1)),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),e(Ot(!1)),console.error("[getAccount]",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),t(function(){var t=Object(f.a)(d.a.mark((function t(e){var n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(Rt(!0)),t.next=4,It();case 4:return n=t.sent,t.next=7,n.getBond();case 7:r=t.sent,e(Nt({bond:r})),e(Rt(!1)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),e(St(t.t0)),e(Rt(!1));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}())}),[t,e]);var n=Object(r.useCallback)((function(){t(function(){var t=Object(f.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(Ot(!0)),t.next=4,kt();case 4:e(Ot(!1)),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),e(Ot(!1)),console.error("[signIn]",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}())}),[]),a=Object(r.useCallback)((function(){t(function(){var t=Object(f.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yt();case 2:e(vt(null));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[]);return Object(_.jsx)(bt,{onLoginClick:n,onLogoutClick:a,account:e})}var Ft=n(98),Lt=n.n(Ft);function Wt(t){var e,n=t.children,r=t.hasNavigation,a=void 0===r||r,o=t.hasFooter,c=void 0===o||o,i=t.size,u=void 0===i?"medium":i,s=t.className,l=void 0===s?"":s,p=t.bodyClassName,d=void 0===p?"":p,f=dt()(Lt.a.page__body,d,(e={},Object(lt.a)(e,Lt.a["page__body--large"],"large"===u),Object(lt.a)(e,Lt.a["page__body--unrestricted"],"unrestricted"===u),e));return Object(_.jsxs)("div",{className:"".concat(Lt.a.page," ").concat(l),children:[a&&Object(_.jsx)(Dt,{}),Object(_.jsx)("main",{className:f,children:n}),c&&Object(_.jsx)(ft,{})]})}function Bt(t){var e=t.council;return Object(_.jsx)("section",{children:e.map((function(t){return Object(_.jsx)("div",{children:t},t)}))})}var zt=Object(tt.a)({initialState:{council:[],loading:!1,errors:[]},name:"council",reducers:{setCouncil:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{council:e.payload})},setCouncilLoading:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{loading:e.payload})},setCouncilErrors:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{errors:e.payload})}}}),Ut=zt.actions,qt=Ut.setCouncil,Ht=Ut.setCouncilErrors,Kt=Ut.setCouncilLoading,Vt=zt.reducer;function Yt(){var t=Object(i.b)(),e=Object(i.c)((function(t){return t.council.council}));return Object(r.useEffect)((function(){t(function(){var t=Object(f.a)(d.a.mark((function t(e){var n,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e(Kt(!0)),t.next=4,It();case 4:return n=t.sent,t.next=7,n.getCouncil();case 7:r=t.sent,e(qt(r)),e(Kt(!1)),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(0),e(Ht(t.t0)),e(Kt(!1));case 16:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}())}),[]),Object(_.jsx)(Bt,{council:e})}var Jt,Xt,Gt=n(205),Qt=n(374),Zt=n(379),$t=n(368),te=n(378),ee=n(206),ne=n.n(ee);function re(t){var e=t.labelA,n=t.labelB,r=t.onChange,a=t.value;return Object(_.jsxs)("span",{className:ne.a.root,children:[Object(_.jsx)("span",{children:e}),Object(_.jsx)(te.a,{value:a,onChange:function(t,e){return r(e)}}),Object(_.jsx)("span",{children:n})]})}function ae(t){var e=t.onChange,n=t.values,r=t.markets;function a(t,r){var a=n.payoutNumerators;a[r]=Number(t),e(Object(s.a)(Object(s.a)({},n),{},{payoutNumerators:a}))}var o=r.find((function(t){return t.id===n.marketId})),c=n.payoutNumerators.reduce((function(t,e){return t+e}),0);return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{children:Object(_.jsx)(Qt.a,{label:I("resoluteMarketForm.input.marketId"),value:n.marketId,onChange:function(t){var a,o,c,i,u=r.find((function(e){return e.id===t.target.value}));e(Object(s.a)(Object(s.a)({},n),{},{marketId:null!==(a=null===u||void 0===u?void 0:u.id)&&void 0!==a?a:"",marketDescription:null!==(o=null===u||void 0===u?void 0:u.description)&&void 0!==o?o:"",collateralTokenId:null!==(c=null===u||void 0===u?void 0:u.collateralTokenId)&&void 0!==c?c:"",payoutNumerators:null!==(i=null===u||void 0===u?void 0:u.outcomeTags.map((function(t){return 0})))&&void 0!==i?i:[]}))},children:r.map((function(t){return Object(_.jsxs)(Zt.a,{value:t.id,children:[t.id," - ",t.description]},t.id)}))})}),Object(_.jsxs)("div",{children:[Object(_.jsx)("br",{}),null===o||void 0===o?void 0:o.extraInfo]}),Object(_.jsx)(re,{labelA:I("resoluteMarketForm.input.validMarket"),labelB:I("resoluteMarketForm.input.invalidMarket"),value:n.isInvalidMarket,onChange:function(t){e(Object(s.a)(Object(s.a)({},n),{},{isInvalidMarket:t}))}}),Object(_.jsx)("div",{children:!n.isInvalidMarket&&Object(_.jsxs)("div",{children:[null===o||void 0===o?void 0:o.outcomeTags.map((function(t,e){return Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:t,onChange:function(t){return a(t.target.value,e)},value:n.payoutNumerators[e]||"0",type:"number",InputProps:{endAdornment:Object(_.jsx)($t.a,{position:"end",children:Object(_.jsx)("span",{children:"%"})})}})},e)})),100!==c&&Object(_.jsx)("p",{children:I("resoluteMarketForm.error.not100")})]})})]})}function oe(t){var e=t.onChange,n=t.values;return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:I("newCouncilForm.input.accountId"),onChange:function(t){e(Object(s.a)(Object(s.a)({},n),{},{accountId:t.currentTarget.value}))},value:n.accountId})}),Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:I("newCouncilForm.input.description"),onChange:function(t){e(Object(s.a)(Object(s.a)({},n),{},{description:t.currentTarget.value}))},value:n.description})})]})}function ce(t){var e=t.onChange,n=t.values;return Object(_.jsxs)("div",{children:[Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:I("addTokenWhitelist.input.accountId"),onChange:function(t){e(Object(s.a)(Object(s.a)({},n),{},{accountId:t.currentTarget.value}))},value:n.accountId})}),Object(_.jsx)("div",{children:Object(_.jsx)(M.a,{label:I("addTokenWhitelist.input.description"),onChange:function(t){e(Object(s.a)(Object(s.a)({},n),{},{description:t.currentTarget.value}))},value:n.description})})]})}function ie(t){var e=t.open,n=t.markets,a=t.onRequestClose,o=t.onSubmit,c=Object(r.useState)({newCouncil:{accountId:"",description:""},addTokenWhitelist:{accountId:"",description:""},resoluteMarket:{isInvalidMarket:!1,marketId:"",marketDescription:"",collateralTokenId:"",payoutNumerators:[]},type:Jt.ResoluteMarket}),i=Object(b.a)(c,2),u=i[0],l=i[1];return Object(_.jsxs)(T,{open:e,title:I("proposalDialog.title"),onSubmitClick:function(){return o(u)},onRequestClose:a,children:[Object(_.jsxs)(Qt.a,{value:u.type,onChange:function(t){l(Object(s.a)(Object(s.a)({},u),{},{type:t.target.value}))},children:[Object(_.jsx)(Zt.a,{value:Jt.ResoluteMarket,children:I("proposalDialog.types.resoluteMarket")}),Object(_.jsx)(Zt.a,{value:Jt.NewCouncil,children:I("proposalDialog.types.newCouncil")}),Object(_.jsx)(Zt.a,{value:Jt.AddTokenWhitelist,children:I("proposalDialog.types.addTokenWhitelist")})]}),u.type===Jt.ResoluteMarket&&Object(_.jsx)(ae,{markets:n,values:u.resoluteMarket,onChange:function(t){l(Object(s.a)(Object(s.a)({},u),{},{resoluteMarket:t}))}}),u.type===Jt.NewCouncil&&Object(_.jsx)(oe,{values:u.newCouncil,onChange:function(t){l(Object(s.a)(Object(s.a)({},u),{},{newCouncil:t}))}}),u.type===Jt.AddTokenWhitelist&&Object(_.jsx)(ce,{values:u.addTokenWhitelist,onChange:function(t){l(Object(s.a)(Object(s.a)({},u),{},{addTokenWhitelist:t}))}})]})}!function(t){t.ResoluteMarket="ResoluteMarket",t.NewCouncil="NewCouncil",t.AddTokenWhitelist="AddTokenWhitelist"}(Jt||(Jt={})),function(t){t.Vote="Vote",t.Success="Success",t.Reject="Reject",t.Finalized="Finalized",t.Rejected="Rejected"}(Xt||(Xt={}));var ue=n(369),se=n(370),le=n(372),pe=n(371),de=n(215);function fe(t){var e=t.proposal,n=t.loggedInAccount,r=t.onNoClick,a=t.onYesClick,o=t.onFinalizeClick,c=new Date(e.vote_period_end/1e6),i=(null===n||void 0===n?void 0:n.accountId)||"";console.log("[] proposal -> ",e);var u=Boolean(e.votes[i]);return Object(_.jsxs)(ue.a,{children:[Object(_.jsx)(se.a,{onClick:function(){e.kind.type===Jt.ResoluteMarket&&window.open("".concat("https://fluxprotocol.github.io/beta/#/beta/markets/").concat(e.kind.market_id),"_blank")},children:Object(_.jsxs)(pe.a,{children:[Object(_.jsx)(de.a,{gutterBottom:!0,variant:"h5",component:"h2",children:e.description}),Object(_.jsx)("pre",{children:JSON.stringify(e.kind,null,4)}),Object(_.jsx)(de.a,{gutterBottom:!0,variant:"body1",component:"p",children:I("proposalInfo.label.status",{status:e.status})}),Object(_.jsx)(de.a,{gutterBottom:!0,variant:"body1",component:"p",children:I("proposalInfo.label.creator",{creator:e.proposer})}),Object(_.jsx)(de.a,{gutterBottom:!0,variant:"body1",component:"p",children:I("proposalInfo.label.votePeriodEnd",{date:c.toString()})})]})}),Object(_.jsxs)(le.a,{children:[e.status===Xt.Vote&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(y,{disabled:u,onClick:a,children:I("proposalInfo.action.voteYes",{amount:e.vote_yes.toString()})}),Object(_.jsx)(y,{disabled:u,onClick:r,children:I("proposalInfo.action.voteNo",{amount:e.vote_no.toString()})})]}),e.status===Xt.Success&&Object(_.jsx)(y,{onClick:o,children:I("proposalInfo.action.finalize")})]})]})}var be=n(207),je=n.n(be);function he(t){var e=t.onProposalSubmit,n=t.onNoClick,a=t.onYesClick,o=t.onFinalizeClick,c=t.onRequestMoreProposals,i=t.hasMoreProposals,u=t.proposals,s=t.markets,l=t.loggedInAccount,p=Object(r.useState)(!1),d=Object(b.a)(p,2),f=d[0],j=d[1];return Object(_.jsxs)("section",{children:[Object(_.jsx)("button",{onClick:function(){j(!0)},children:I("proposalsOverview.create")}),Object(_.jsx)(Gt.a,{dataLength:u.length,next:c,hasMore:i,loader:Object(_.jsx)("div",{}),className:je.a.infiniteScroll,children:u.map((function(t,e){return Object(_.jsx)(fe,{proposal:t,onNoClick:function(){return n(t,e)},onYesClick:function(){return a(t,e)},onFinalizeClick:function(){return o(t,e)},loggedInAccount:l},e)}))}),Object(_.jsx)(ie,{markets:s,open:f,onRequestClose:function(){return j(!1)},onSubmit:e})]})}var ve=n(148),Oe=n(208),xe=n(84);function ke(t){return{id:t.id,description:t.description,outcomeTags:t.outcome_tags,extraInfo:t.extra_info,collateralTokenId:t.pool.collateral_token_id}}var me,ge=new xe.InMemoryCache,_e=Object(xe.createHttpLink)({uri:W}),ye=new xe.ApolloClient({cache:ge,link:_e,defaultOptions:{watchQuery:{fetchPolicy:"cache-and-network"}}});function we(){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(f.a)(d.a.mark((function t(){var e,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ye.query({query:Object(xe.gql)(me||(me=Object(Oe.a)(["\n                query ExiredMarkets {\n                    markets: getMarkets(filters: { expired: true, finalized: false }) {\n                        items {\n                            id\n                            description\n                            outcome_tags\n                            extra_info\n                            pool {\n                                collateral_token_id\n                            }\n                        }\n                    }\n                }\n            "])))});case 3:return e=t.sent,n=e.data.markets.items,t.abrupt("return",n.map((function(t){return ke(t)})));case 8:return t.prev=8,t.t0=t.catch(0),console.error("[getExpiredMarkets]",t.t0),t.abrupt("return",[]);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}var Ae=n(211),Ie=n.n(Ae);function Te(t,e){var n=new Ie.a(10).pow(e);return t.map((function(t){return n.mul(t/100).toFixed(0)}))}var Me=Object(tt.a)({initialState:{hasMoreProposals:!0,proposals:[],expiredMarkets:[],loading:!1,errors:[]},name:"proposals",reducers:{setProposals:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{proposals:e.payload})},setProposalsLoading:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{loading:e.payload})},setProposalsErrors:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{errors:e.payload})},setProposalsHasMore:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{hasMoreProposals:e.payload})},setProposalsExpiredMarkets:function(t,e){return Object(s.a)(Object(s.a)({},t),{},{expiredMarkets:e.payload})}}}),Pe=Me.actions,Se=Pe.setProposals,Ne=Pe.setProposalsLoading,Re=(Pe.setProposalsErrors,Pe.setProposalsExpiredMarkets),Ee=Pe.setProposalsHasMore,De=Me.reducer;function Fe(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(){var e=Object(f.a)(d.a.mark((function e(n,r){var a,o,c,i,u,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,It();case 2:return a=e.sent,o=1e3,t&&n(Se([])),n(Ne(!0)),c=r(),i=c.proposals.proposals,u=i.length.toString(),e.next=11,a.getProposals(u,o.toString());case 11:(s=e.sent).length===o?n(Ee(!0)):n(Ee(!1)),n(Se([].concat(Object(ve.a)(c.proposals.proposals),Object(ve.a)(s)))),n(Ne(!1));case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}function Le(){var t=Object(i.b)(),e=Object(i.c)((function(t){return t.proposals.proposals})),n=Object(i.c)((function(t){return t.proposals.hasMoreProposals})),a=Object(i.c)((function(t){return t.proposals.expiredMarkets})),o=Object(i.c)((function(t){return t.account.account}));return Object(r.useEffect)((function(){t(Fe(!0)),t(function(){var t=Object(f.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,we();case 2:n=t.sent,e(Re(n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[t]),Object(_.jsx)(he,{onProposalSubmit:function(e){t(function(t){return function(){var e=Object(f.a)(d.a.mark((function e(n){var r,a,o,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,It();case 2:return r=e.sent,e.next=5,V();case 5:if(a=e.sent,t.type!==Jt.ResoluteMarket){e.next=14;break}return e.next=9,a.getTokenMetadata(t.resoluteMarket.collateralTokenId);case 9:o=e.sent,c=Te(t.resoluteMarket.payoutNumerators,o.decimals),r.createResoluteMarketProposal(I("proposal.resoluteMarket.description",{description:t.resoluteMarket.marketDescription}),t.resoluteMarket.marketId,t.resoluteMarket.isInvalidMarket?void 0:c),e.next=15;break;case 14:t.type===Jt.NewCouncil?r.createNewCouncilProposal(t.newCouncil.description,t.newCouncil.accountId):t.type===Jt.AddTokenWhitelist&&r.createAddTokenToWhitelistProposal(t.addTokenWhitelist.description,t.addTokenWhitelist.accountId);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(e))},proposals:e,markets:a,onYesClick:function(e,n){var r;t((r=n.toString(),function(){var t=Object(f.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,It();case 2:t.sent.vote(r,"Yes");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},onNoClick:function(e,n){var r;t((r=n.toString(),function(){var t=Object(f.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,It();case 2:t.sent.vote(r,"No");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},onFinalizeClick:function(e,n){var r;t((r=n.toString(),function(){var t=Object(f.a)(d.a.mark((function t(e){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,It();case 2:t.sent.finalize(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},hasMoreProposals:n,onRequestMoreProposals:function(){console.log("More!"),t(Fe())},loggedInAccount:o})}var We={root:function(){return"/"},council:function(){return"/council"},auth:function(){return"/auth"}},Be=[{component:function(){return Object(_.jsxs)(Wt,{children:[Object(_.jsx)("h1",{children:I("home.title")}),Object(_.jsx)(Le,{})]})},exact:!0,inNavigation:!1,key:"home",label:"Home",path:We.root()},{component:function(){return Object(_.jsxs)(Wt,{children:[Object(_.jsx)("h1",{children:I("council.title")}),Object(_.jsx)(Yt,{})]})},exact:!0,inNavigation:!1,key:"council",label:"Council",path:We.council()},{component:function(){return Object(_.jsx)(Wt,{children:Object(_.jsx)(st,{})})},exact:!0,inNavigation:!1,key:"auth",label:"Auth",path:We.auth()}];function ze(){return Object(_.jsx)(l.c,{children:Be.map((function(t){return Object(r.createElement)(l.a,Object(s.a)(Object(s.a)({},t),{},{key:t.key}))}))})}n(317);var Ue=n(26),qe=n(212),He=n(82),Ke=Object(Ue.combineReducers)({account:xt,council:Vt,proposals:De,dao:Et,auth:ct}),Ve=function(){return"production"!==Object({NODE_ENV:"production",PUBLIC_URL:"https://fluxprotocol.github.io/dao-app",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://mainnet-api.flux.xyz/graphql",REACT_APP_DAO_ACCOUNT_ID:"dao.counselor.near",REACT_APP_FLUX_MARKET_DETAIL_URL:"https://fluxprotocol.github.io/beta/#/beta/markets/",REACT_APP_NETWORK:"mainnet"}).REACT_APP_APP_ENV?Object(qe.composeWithDevTools)(Object(Ue.applyMiddleware)(He.a)):Object(Ue.applyMiddleware)(He.a)};var Ye=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Ve();return Object(Ue.createStore)(Ke,t,e)}({});o.a.render(Object(_.jsx)(i.a,{store:Ye,children:Object(_.jsx)(c.a,{children:Object(_.jsx)(u.b,{injectFirst:!0,children:Object(_.jsx)(ze,{})})})}),document.getElementById("root"))},98:function(t,e,n){t.exports={page:"Page_page__1vav1",page__body:"Page_page__body__3V8v2","page__body--large":"Page_page__body--large__27pTP","page__body--unrestricted":"Page_page__body--unrestricted__3wRih"}}},[[318,1,2]]]);
//# sourceMappingURL=main.3f9a762e.chunk.js.map